/**
 ******************************************************************************
 * @file      udelay.c
 * @brief     本文实现微妙延时函数.
 * @details   This file including all API functions's implement of udelay.c.
 * @copyright
 *
 ******************************************************************************
 */
 
/*-----------------------------------------------------------------------------
 Section: Includes
 ----------------------------------------------------------------------------*/
#include <types.h>
#include <udelay.h>

/*-----------------------------------------------------------------------------
 Section: Type Definitions
 ----------------------------------------------------------------------------*/
/* NONE */

/*-----------------------------------------------------------------------------
 Section: Constant Definitions
 ----------------------------------------------------------------------------*/
/* NONE */ 

/*-----------------------------------------------------------------------------
 Section: Global Variables
 ----------------------------------------------------------------------------*/
/* NONE */

/*-----------------------------------------------------------------------------
 Section: Local Variables
 ----------------------------------------------------------------------------*/
/* NONE */

/*-----------------------------------------------------------------------------
 Section: Local Function Prototypes
 ----------------------------------------------------------------------------*/
/* NONE */

/*-----------------------------------------------------------------------------
 Section: Global Function Prototypes
 ----------------------------------------------------------------------------*/
/* NONE */
extern uint32_t
bsp_timer_get(void);

/*-----------------------------------------------------------------------------
 Section: Function Definitions
 ----------------------------------------------------------------------------*/


/**
 ******************************************************************************
 * @brief   微妙延时
 * @param[in]  us   : 时间(微妙)
 * @retval     None
 *
 * @details
 *  实际为忙等，若需长时间延时请使用taskDelay
 ******************************************************************************
 */
void
_usleep(uint32_t us)
{
    uint32_t time_out = us + bsp_timer_get();
    while (bsp_timer_get() < time_out)
    {
        ;   /* 忙等 */
    }
}

/*--------------------------------udelay.c-----------------------------------*/
